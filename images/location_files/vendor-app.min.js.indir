var EditVendorAppFallback={},Utils,Utils,Utils,Utils,Utils,Utils,Utils,Utils,Utils,EditOperations,EditOperations,EditOperations,EditOperations,Edit,Edit,Edit,Utils,Shared,Shared;
/*!
  * Bootstrap v5.0.0 (https://getbootstrap.com/)
  * Copyright 2011-2021 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).bootstrap=e()}(this,(function(){"use strict";const t="transitionend",e=t=>{let e=t.getAttribute("data-bs-target");if(!e||"#"===e){let i=t.getAttribute("href");if(!i||!i.includes("#")&&!i.startsWith("."))return null;i.includes("#")&&!i.startsWith("#")&&(i=`#${i.split("#")[1]}`),e=i&&"#"!==i?i.trim():null}return e},i=t=>{const i=e(t);return i&&document.querySelector(i)?i:null},r=t=>{const i=e(t);return i?document.querySelector(i):null},n=t=>{if(!t)return 0;let{transitionDuration:e,transitionDelay:i}=window.getComputedStyle(t);const r=Number.parseFloat(e),n=Number.parseFloat(i);return r||n?(e=e.split(",")[0],i=i.split(",")[0],1e3*(Number.parseFloat(e)+Number.parseFloat(i))):0},s=t=>(t[0]||t).nodeType,o=(e,i)=>{let r=!1;const n=i+5;e.addEventListener(t,(function i(){r=!0,e.removeEventListener(t,i)})),setTimeout((()=>{r||(e=>{e.dispatchEvent(new Event(t))})(e)}),n)},a=()=>{const{jQuery:t}=window;return t&&!document.body.hasAttribute("data-bs-no-jquery")?t:null},l=new Map;var c={set(t,e,i){l.has(t)||l.set(t,new Map);const r=l.get(t);r.has(e)||0===r.size?r.set(e,i):console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(r.keys())[0]}.`)},get:(t,e)=>l.has(t)&&l.get(t).get(e)||null,remove(t,e){if(!l.has(t))return;const i=l.get(t);i.delete(e),0===i.size&&l.delete(t)}};const d=/[^.]*(?=\..*)\.|.*/,u=/\..*/,g=/::\d+$/,h={};let p=1;const m={mouseenter:"mouseover",mouseleave:"mouseout"},f=/^(mouseenter|mouseleave)/i,E=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function v(t,e){return e&&`${e}::${p++}`||t.uidEvent||p++}function S(t){const e=v(t);return t.uidEvent=e,h[e]=h[e]||{},h[e]}function b(t,e,i=null){const r=Object.keys(t);for(let n=0,s=r.length;n<s;n++){const s=t[r[n]];if(s.originalHandler===e&&s.delegationSelector===i)return s}return null}function y(t,e,i){const r="string"==typeof e,n=r?i:e;let s=O(t);return E.has(s)||(s=t),[r,n,s]}function C(t,e,i,r,n){if("string"!=typeof e||!t)return;if(i||(i=r,r=null),f.test(e)){const t=t=>function(e){if(!e.relatedTarget||e.relatedTarget!==e.delegateTarget&&!e.delegateTarget.contains(e.relatedTarget))return t.call(this,e)};r?r=t(r):i=t(i)}const[s,o,a]=y(e,i,r),l=S(t),c=l[a]||(l[a]={}),u=b(c,o,s?i:null);if(u)return void(u.oneOff=u.oneOff&&n);const g=v(o,e.replace(d,"")),h=s?function(t,e,i){return function r(n){const s=t.querySelectorAll(e);for(let{target:o}=n;o&&o!==this;o=o.parentNode)for(let a=s.length;a--;)if(s[a]===o)return n.delegateTarget=o,r.oneOff&&w.off(t,n.type,e,i),i.apply(o,[n]);return null}}(t,i,r):function(t,e){return function i(r){return r.delegateTarget=t,i.oneOff&&w.off(t,r.type,e),e.apply(t,[r])}}(t,i);h.delegationSelector=s?i:null,h.originalHandler=o,h.oneOff=n,h.uidEvent=g,c[g]=h,t.addEventListener(a,h,s)}function U(t,e,i,r,n){const s=b(e[i],r,n);s&&(t.removeEventListener(i,s,Boolean(n)),delete e[i][s.uidEvent])}function O(t){return t=t.replace(u,""),m[t]||t}const w={on(t,e,i,r){C(t,e,i,r,!1)},one(t,e,i,r){C(t,e,i,r,!0)},off(t,e,i,r){if("string"!=typeof e||!t)return;const[n,s,o]=y(e,i,r),a=o!==e,l=S(t),c=e.startsWith(".");if(void 0!==s){if(!l||!l[o])return;return void U(t,l,o,s,n?i:null)}c&&Object.keys(l).forEach((i=>{!function(t,e,i,r){const n=e[i]||{};Object.keys(n).forEach((s=>{if(s.includes(r)){const r=n[s];U(t,e,i,r.originalHandler,r.delegationSelector)}}))}(t,l,i,e.slice(1))}));const d=l[o]||{};Object.keys(d).forEach((i=>{const r=i.replace(g,"");if(!a||e.includes(r)){const e=d[i];U(t,l,o,e.originalHandler,e.delegationSelector)}}))},trigger(t,e,i){if("string"!=typeof e||!t)return null;const r=a(),n=O(e),s=e!==n,o=E.has(n);let l,c=!0,d=!0,u=!1,g=null;return s&&r&&(l=r.Event(e,i),r(t).trigger(l),c=!l.isPropagationStopped(),d=!l.isImmediatePropagationStopped(),u=l.isDefaultPrevented()),o?(g=document.createEvent("HTMLEvents"),g.initEvent(n,c,!0)):g=new CustomEvent(e,{bubbles:c,cancelable:!0}),void 0!==i&&Object.keys(i).forEach((t=>{Object.defineProperty(g,t,{get:()=>i[t]})})),u&&g.preventDefault(),d&&t.dispatchEvent(g),g.defaultPrevented&&void 0!==l&&l.preventDefault(),g}};function L(t){return"true"===t||"false"!==t&&(t===Number(t).toString()?Number(t):""===t||"null"===t?null:t)}function T(t){return t.replace(/[A-Z]/g,(t=>`-${t.toLowerCase()}`))}const A={setDataAttribute(t,e,i){t.setAttribute(`data-bs-${T(e)}`,i)},removeDataAttribute(t,e){t.removeAttribute(`data-bs-${T(e)}`)},getDataAttributes(t){if(!t)return{};const e={};return Object.keys(t.dataset).filter((t=>t.startsWith("bs"))).forEach((i=>{let r=i.replace(/^bs/,"");r=r.charAt(0).toLowerCase()+r.slice(1,r.length),e[r]=L(t.dataset[i])})),e},getDataAttribute:(t,e)=>L(t.getAttribute(`data-bs-${T(e)}`)),offset(t){const e=t.getBoundingClientRect();return{top:e.top+document.body.scrollTop,left:e.left+document.body.scrollLeft}},position:t=>({top:t.offsetTop,left:t.offsetLeft})},I={find:(t,e=document.documentElement)=>[].concat(...Element.prototype.querySelectorAll.call(e,t)),findOne:(t,e=document.documentElement)=>Element.prototype.querySelector.call(e,t),children:(t,e)=>[].concat(...t.children).filter((t=>t.matches(e))),parents(t,e){const i=[];let r=t.parentNode;for(;r&&r.nodeType===Node.ELEMENT_NODE&&3!==r.nodeType;)r.matches(e)&&i.push(r),r=r.parentNode;return i},prev(t,e){let i=t.previousElementSibling;for(;i;){if(i.matches(e))return[i];i=i.previousElementSibling}return[]},next(t,e){let i=t.nextElementSibling;for(;i;){if(i.matches(e))return[i];i=i.nextElementSibling}return[]}},x="collapse",_="bs.collapse",P={toggle:!0,parent:""},H={toggle:"boolean",parent:"(string|element)"},D="show",k="collapse",M="collapsing",$="collapsed",q="width",R='[data-bs-toggle="collapse"]';class j extends class{constructor(t){(t="string"==typeof t?document.querySelector(t):t)&&(this._element=t,c.set(this._element,this.constructor.DATA_KEY,this))}dispose(){c.remove(this._element,this.constructor.DATA_KEY),w.off(this._element,`.${this.constructor.DATA_KEY}`),this._element=null}static getInstance(t){return c.get(t,this.DATA_KEY)}static get VERSION(){return"5.0.0"}}{constructor(t,e){super(t),this._isTransitioning=!1,this._config=this._getConfig(e),this._triggerArray=I.find(`${R}[href="#${this._element.id}"],${R}[data-bs-target="#${this._element.id}"]`);const r=I.find(R);for(let t=0,e=r.length;t<e;t++){const e=r[t],n=i(e),s=I.find(n).filter((t=>t===this._element));null!==n&&s.length&&(this._selector=n,this._triggerArray.push(e))}this._parent=this._config.parent?this._getParent():null,this._config.parent||this._addAriaAndCollapsedClass(this._element,this._triggerArray),this._config.toggle&&this.toggle()}static get Default(){return P}static get DATA_KEY(){return _}toggle(){this._element.classList.contains(D)?this.hide():this.show()}show(){if(this._isTransitioning||this._element.classList.contains(D))return;let t,e;this._parent&&(t=I.find(".show, .collapsing",this._parent).filter((t=>"string"==typeof this._config.parent?t.getAttribute("data-bs-parent")===this._config.parent:t.classList.contains(k))),0===t.length&&(t=null));const i=I.findOne(this._selector);if(t){const r=t.find((t=>i!==t));if(e=r?c.get(r,_):null,e&&e._isTransitioning)return}if(w.trigger(this._element,"show.bs.collapse").defaultPrevented)return;t&&t.forEach((t=>{i!==t&&j.collapseInterface(t,"hide"),e||c.set(t,_,null)}));const r=this._getDimension();this._element.classList.remove(k),this._element.classList.add(M),this._element.style[r]=0,this._triggerArray.length&&this._triggerArray.forEach((t=>{t.classList.remove($),t.setAttribute("aria-expanded",!0)})),this.setTransitioning(!0);const s=`scroll${r[0].toUpperCase()+r.slice(1)}`,a=n(this._element);w.one(this._element,"transitionend",(()=>{this._element.classList.remove(M),this._element.classList.add(k,D),this._element.style[r]="",this.setTransitioning(!1),w.trigger(this._element,"shown.bs.collapse")})),o(this._element,a),this._element.style[r]=`${this._element[s]}px`}hide(){if(this._isTransitioning||!this._element.classList.contains(D))return;if(w.trigger(this._element,"hide.bs.collapse").defaultPrevented)return;const t=this._getDimension();this._element.style[t]=`${this._element.getBoundingClientRect()[t]}px`,this._element.offsetHeight,this._element.classList.add(M),this._element.classList.remove(k,D);const e=this._triggerArray.length;if(e>0)for(let t=0;t<e;t++){const e=this._triggerArray[t],i=r(e);i&&!i.classList.contains(D)&&(e.classList.add($),e.setAttribute("aria-expanded",!1))}this.setTransitioning(!0),this._element.style[t]="";const i=n(this._element);w.one(this._element,"transitionend",(()=>{this.setTransitioning(!1),this._element.classList.remove(M),this._element.classList.add(k),w.trigger(this._element,"hidden.bs.collapse")})),o(this._element,i)}setTransitioning(t){this._isTransitioning=t}dispose(){super.dispose(),this._config=null,this._parent=null,this._triggerArray=null,this._isTransitioning=null}_getConfig(t){return(t={...P,...t}).toggle=Boolean(t.toggle),((t,e,i)=>{Object.keys(i).forEach((r=>{const n=i[r],o=e[r],a=o&&s(o)?"element":null==(l=o)?`${l}`:{}.toString.call(l).match(/\s([a-z]+)/i)[1].toLowerCase();var l;if(!new RegExp(n).test(a))throw new TypeError(`${t.toUpperCase()}: Option "${r}" provided type "${a}" but expected type "${n}".`)}))})(x,t,H),t}_getDimension(){return this._element.classList.contains(q)?q:"height"}_getParent(){let{parent:t}=this._config;s(t)?void 0===t.jquery&&void 0===t[0]||(t=t[0]):t=I.findOne(t);const e=`${R}[data-bs-parent="${t}"]`;return I.find(e,t).forEach((t=>{const e=r(t);this._addAriaAndCollapsedClass(e,[t])})),t}_addAriaAndCollapsedClass(t,e){if(!t||!e.length)return;const i=t.classList.contains(D);e.forEach((t=>{i?t.classList.remove($):t.classList.add($),t.setAttribute("aria-expanded",i)}))}static collapseInterface(t,e){let i=c.get(t,_);const r={...P,...A.getDataAttributes(t),..."object"==typeof e&&e?e:{}};if(!i&&r.toggle&&"string"==typeof e&&/show|hide/.test(e)&&(r.toggle=!1),i||(i=new j(t,r)),"string"==typeof e){if(void 0===i[e])throw new TypeError(`No method named "${e}"`);i[e]()}}static jQueryInterface(t){return this.each((function(){j.collapseInterface(this,t)}))}}var N,F,B;return w.on(document,"click.bs.collapse.data-api",R,(function(t){("A"===t.target.tagName||t.delegateTarget&&"A"===t.delegateTarget.tagName)&&t.preventDefault();const e=A.getDataAttributes(this),r=i(this);I.find(r).forEach((t=>{const i=c.get(t,_);let r;i?(null===i._parent&&"string"==typeof e.parent&&(i._config.parent=e.parent,i._parent=i._getParent()),r="toggle"):r=e,j.collapseInterface(t,r)}))})),N=x,F=j,B=()=>{const t=a();if(t){const e=t.fn[N];t.fn[N]=F.jQueryInterface,t.fn[N].Constructor=F,t.fn[N].noConflict=()=>(t.fn[N]=e,F.jQueryInterface)}},"loading"===document.readyState?document.addEventListener("DOMContentLoaded",B):B(),{Collapse:j}})),function(t){t.BrowserUtils=class{static onWindowLoad(t){"complete"===document.readyState?t():window.addEventListener("load",t)}static onDocumentReady(t){"loading"!==document.readyState?t():document.addEventListener("DOMContentLoaded",t)}}}(Utils||(Utils={})),function(t){t.EventUtils=class{static triggerEvent(t,e){let i=document.createEvent("HTMLEvents");i.initEvent(e,!0,!1),t.dispatchEvent(i)}static triggerCustomEvent(t,e,i){var r;window.CustomEvent&&"function"==typeof window.CustomEvent?r=new CustomEvent(e,{detail:i}):(r=document.createEvent("CustomEvent")).initCustomEvent(e,!0,!0,i),t.dispatchEvent(r)}static oneTimeEvent(t,e,i){let r=function(n){t.removeEventListener(e,r),i(n)};t.addEventListener(e,r)}}}(Utils||(Utils={})),function(t){t.ImageResize=class{constructor(e){this.triggerImageChangedEvent=()=>{t.EventUtils.triggerCustomEvent(this.image,"imageChanged")},this.image=document.querySelector(e),this.imageContainer=this.image.parentNode}resizeImageToFitContainer(){this.setImageVisible(!1),this.image.height=this.calcImageHeightToFitContainer(this.image.naturalWidth,this.image.naturalHeight),this.setImageVisible(!0)}setNewImageToFitContainer(e,i,r){let n=this.calcImageHeightToFitContainer(e,i);this.triggerImageChangingEvent(),this.setImageVisible(!1),t.EventUtils.oneTimeEvent(this.image,"load",this.triggerImageChangedEvent),this.image.height=n,this.image.src=r,this.setImageVisible(!0)}triggerImageChangingEvent(){t.EventUtils.triggerCustomEvent(this.image,"imageChanging")}calcImageHeightToFitContainer(t,e){let i,r,n=this.getPixelPropValue(this.imageContainer,"padding-left")+this.getPixelPropValue(this.imageContainer,"padding-right"),s=this.imageContainer.clientWidth-n-1,o=s/t,a=this.getPixelPropValue(this.imageContainer,"padding-bottom")+this.getPixelPropValue(this.imageContainer,"padding-top"),l=this.imageContainer.clientHeight-a-1,c=l/e;return(o<1||c<1)&&(i=o<c?t/s:e/l),r=i?e/i:e,r}getPixelPropValue(t,e){return parseFloat(getComputedStyle(t)[e].replace("px",""))}setImageVisible(t){t?this.image.classList.remove("d-none"):this.image.classList.add("d-none")}}}(Utils||(Utils={})),function(t){t.HtmlUtils=class{static getAriaLabeledBy(t){return t.getAttribute("aria-labelledby").split(" ")}static getIdSelector(t){return`#${t}`}static displayElement(t,e,i){const r="d-none";let n=document.querySelector(t);i?(e&&n.classList.add(e),n.classList.remove(r)):(n.classList.add(r),e&&n.classList.remove(e))}static displayElementDefault(e,i){t.HtmlUtils.displayElement(e,void 0,i)}static displayElementBlock(e,i){t.HtmlUtils.displayElement(e,"d-block",i)}static displayElementFlex(e,i){t.HtmlUtils.displayElement(e,"d-flex",i)}static isInputChecked(t){return t.checked}static closestWithClass(t,e,i){if(i&&t.classList.contains(e))return t;let r=t;for(;(r=r.parentNode)&&(!r.classList||!r.classList.contains(e)););return r}static each(t,e){let i=document.querySelectorAll(t);Array.prototype.forEach.call(i,(function(t){e(t)}))}static empty(t){t.textContent=""}}}(Utils||(Utils={})),function(t){t.StringUtils=class{static isNumber(t){return!isNaN(parseInt(t))}}}(Utils||(Utils={})),function(t){class e{static logEvent(t,i){e.logEventInternal(t,i)}static logError(t,i){e.logEventInternal("Error",t,i)}static logEventInternal(t,i,r){if(!("ga"in window))return;let n=ga.getAll()[0];n&&(r?n.send(e.gaEventParam,t,i,r):n.send(e.gaEventParam,t,i))}}e.gaEventParam="event",t.GAEventLogger=e}(Utils||(Utils={})),function(t){t.GAJsErrorLogger=class{constructor(e){this.logJsError=(e,i,r,n,s)=>{let o;return o=e.toLowerCase().indexOf("script error")>-1?"Script error":`Message: ${e}; URL: ${i}; Line: ${r}; Column: ${n}; Stack: ${s&&s.stack?s.stack:""};`,t.GAEventLogger.logError(`${this.page}JsError`,o),!1},this.page=e,window.onerror=this.logJsError}}}(Utils||(Utils={})),function(t){t.TranslateService=class{static translate(e,...i){if(languageTranslate&&languageTranslate.hasOwnProperty(e)){let t=languageTranslate[e];if(0===i.length)return t;let r=t;for(let t=0;t<i.length;t++)r=r.replace(`{${t}}`,i[t]);return r}return t.GAEventLogger.logError("Translate",`Untranslated string '${e}'`),e}}}(Utils||(Utils={})),function(Utils){class JSLoader{constructor(url,testObjectName){this.checkScriptParsed=(url,testObjectName,retryDelayMs,retryCount,maxRetries,resolveCallback,rejectCallback)=>{let testObject=eval(this.testObjectName);if(testObject)return void resolveCallback();if(retryCount>maxRetries)return void rejectCallback(new Error(`Script parse timeout: '${url}'`));let that=this;setTimeout((function(){that.checkScriptParsed(url,testObjectName,retryDelayMs,retryCount+1,maxRetries,resolveCallback,rejectCallback)}),retryDelayMs)},this.url=url,this.testObjectName=testObjectName}async loadScript(){let testObject=eval(this.testObjectName);if(testObject)return Promise.resolve();let useCdn=cdnConfig.useCdn,url=useCdn?cdnConfig.cdnPrefix+this.url:this.url,loadFailed=!1,loadScriptPromise=this.loadScriptInternal(url,useCdn,this.testObjectName);try{await loadScriptPromise}catch(t){loadFailed=!0}return loadFailed?this.loadScriptInternal(this.url,!1,this.testObjectName):Promise.resolve()}loadScriptInternal(t,e,i){return new Promise(((r,n)=>{let s=document.createElement("script");s.onload=()=>this.checkScriptParsed(t,i,25,1,200,r,n),s.onerror=()=>n(new Error(`Script load error: '${t}'`)),e&&(s.crossOrigin="anonymous"),s.src=t,document.body.appendChild(s)}))}}Utils.JSLoader=JSLoader}(Utils||(Utils={})),function(t){t.EditOperationRedirectResult=class{}}(EditOperations||(EditOperations={})),function(t){t.EditOperationErrorResult=class{}}(EditOperations||(EditOperations={})),function(t){t.EditOperationSuccessResult=class{}}(EditOperations||(EditOperations={})),function(t){class e{constructor(t,e,i,r){this.operationId=t,this.operationTriggerSelector=e,this.statusContainerSelector=i,this.apiEndpoint=r}setProgressMediator(t){this.progressMediator=t}setImageResizer(t){this.imgResizer=t}init(){Utils.BrowserUtils.onDocumentReady((()=>{document.querySelector(this.operationTriggerSelector).addEventListener("click",(t=>{this.handleOperationTriggerClick(t.target)}));let t=document.querySelector(e.EditPanelSelector);t&&(t.addEventListener("imageOperationStartEvent",(t=>{let e=t.detail.operationId;this.handleImageOperationStartEvent(e)})),t.addEventListener("imageOperationCompleteEvent",(t=>{let e=t.detail.operationId,i=t.detail.successResult;this.handleImageOperationCompleteEvent(e,i)})))}))}handleOperationTriggerClick(t){if(!this.permitOperation())return;this.initOperation();let i=this.gatherOperationParams(),r=document.querySelector(e.CultureHdnSelector).value;i.culture=r;let n=this.validateData(i);if(n)return this.hideCurrentStatus(),void this.setError(n);Utils.Ajax.post(this.apiEndpoint,i,void 0,(t=>{this.handleOperationResult(t)}),(t=>{this.handleOperationFail(t)})),this.hideCurrentStatus(),this.triggerImageOperationStartEvent(),Utils.GAEventLogger.logEvent(e.EditOperationGACategory,this.operationId)}permitOperation(){return!0}initOperation(){}validateData(t){}getImage(){return document.querySelector(e.EditPanelSelector)}handleOperationResult(t){let i=t.redirectUrl;if(void 0!==i){let t=document.querySelector(e.UrlCultureHdnSelector);if(t){let e="/"+t.value;0!=i.indexOf(e)&&(i=e+i)}return void window.location.replace(i)}let r=t.errorMessage;if(null!=r)return this.triggerImageOperationCompleteEvent(void 0),void this.setError(r);let n=t;this.setCurrentImageInfo(n)}setCurrentImageInfo(t){let i=this.getImage(),r=new Image;r.addEventListener("load",(()=>{this.imgResizer.setNewImageToFitContainer(r.naturalWidth,r.naturalHeight,t.currentImagePreviewLink),this.triggerImageOperationCompleteEvent(t)})),r.addEventListener("error",(()=>{i.src=r.src,this.triggerImageOperationCompleteEvent(t)})),r.src=t.currentImagePreviewLink,r.complete&&Utils.EventUtils.triggerEvent(r,"load"),document.querySelector(e.CurrentImageDimensionSelector).textContent=t.currentImageSizeFormatted.toString(),document.querySelector(e.CurrentImageWeightSelector).textContent=t.currentImageLengthFormatted.toString(),document.querySelector(e.CurrentImageFormatSelector).textContent=t.currentImageFormat.toUpperCase(),document.querySelector(e.WidthToHeightHdnSelector).value=t.currentImageWidthToHeightRatio.toString(),document.querySelector(e.WidthHdnSelector).value=t.currentImageWidth.toString(),document.querySelector(e.HeightHdnSelector).value=t.currentImageHeight.toString()}handleOperationFail(t){this.triggerImageOperationCompleteEvent(void 0),this.setError(Utils.TranslateService.translate("Error_ServiceUnavailable")),Utils.GAEventLogger.logError("Edit",`Response status: ${t.status}`)}setError(t){let i=document.querySelector(e.ErrorMessageTemplateSelector).cloneNode(!0);i.id="operationError",i.textContent=t,i.classList.remove("d-none"),document.querySelector(this.statusContainerSelector).appendChild(i),Utils.HtmlUtils.displayElementFlex(this.statusContainerSelector,!0)}triggerImageOperationStartEvent(){Utils.EventUtils.triggerCustomEvent(document.querySelector(e.EditPanelSelector),"imageOperationStartEvent",{operationId:this.operationId})}triggerImageOperationCompleteEvent(t){Utils.EventUtils.triggerCustomEvent(document.querySelector(e.EditPanelSelector),"imageOperationCompleteEvent",{operationId:this.operationId,successResult:t})}handleImageOperationStartEvent(t){this.operationId===t&&(this.setControlsEnabled(!0),this.setOperationProgress(!0),this.progressMediator.signalOperationProgressStart())}handleImageOperationCompleteEvent(t,e){this.operationId===t&&(this.setOperationProgress(!1),this.setControlsEnabled(!1),this.progressMediator.signalOperationProgressComplete())}hideCurrentStatus(){Utils.HtmlUtils.displayElementFlex(this.statusContainerSelector,!1),Utils.HtmlUtils.empty(document.querySelector(this.statusContainerSelector))}setOperationProgress(t){Utils.HtmlUtils.displayElementDefault(`${this.operationTriggerSelector} > .operation-progress`,t)}setControlsEnabled(t){this.setOperationTriggerEnabled(!t),this.setControlButtonsEnabled(!t)}setOperationTriggerEnabled(t){this.setHtmlInputsEnabled(document.querySelector(this.operationTriggerSelector),t)}setHtmlInputsEnabled(t,e){const i="disabled";e?t.removeAttribute(i):t.setAttribute(i,"")}setControlButtonsEnabled(t){Utils.HtmlUtils.each(e.ControlButtonsSelector,(e=>{this.setHtmlDisabledClass(e,t),this.setAriaDisabledAttr(e,t)}))}setHtmlDisabledClass(t,e){const i="disabled";e?t.classList.remove(i):t.classList.add(i)}setAriaDisabledAttr(t,e){const i="aria-disabled";e?t.setAttribute(i,"false"):t.setAttribute(i,"true")}}e.EditOperationGACategory="Edit",e.MaxSizeHdnSelector="#maxSizeHdn",e.MaxResolutionHdnSelector="#maxResolutionHdn",e.WidthHdnSelector="#widthHdn",e.HeightHdnSelector="#heightHdn",e.WidthToHeightHdnSelector="#wToHRatioHdn",e.CultureHdnSelector="#cultureHdn",e.UrlCultureHdnSelector="#urlCultureHdn",e.EditToolboxSelector="#editToolbox",e.EditPanelSelector="#editPanel",e.OperationProgressSelector="#operationProgress",e.ErrorMessageTemplateSelector="#editErrorMessage",e.ControlButtonsSelector="#uploadNewBtn, #revertBtn, #downloadBtn",e.CurrentImageDimensionSelector="#currentImageDimension",e.CurrentImageWeightSelector="#currentImageWeight",e.CurrentImageFormatSelector="#currentImageFormat",t.BaseOperation=e}(EditOperations||(EditOperations={})),function(t){(t.Progress||(t.Progress={})).OperationStatus=class{constructor(t){this.operationStatusSelector=t}display(t){Utils.HtmlUtils.displayElementFlex(this.operationStatusSelector,t)}setStatus(t){t?document.querySelector(this.operationStatusSelector).textContent=t:Utils.HtmlUtils.empty(document.querySelector(this.operationStatusSelector))}}}(Edit||(Edit={})),function(t){(t.Progress||(t.Progress={})).OperationProgress=class{constructor(t){this.progressIndicatorSelector=t}display(t){Utils.HtmlUtils.displayElementFlex(this.progressIndicatorSelector,t)}}}(Edit||(Edit={})),function(t){(t.Progress||(t.Progress={})).ProgressMediator=class{constructor(){this.operationProgress=new t.Progress.OperationProgress("#operationProgress"),this.operationStatus=new t.Progress.OperationStatus("#operationStatus"),this.initialLoaderActive=!0,Utils.BrowserUtils.onDocumentReady((()=>{Utils.BrowserUtils.onWindowLoad((()=>{this.operationProgress.display(!1),this.initialLoaderActive=!1}))}))}signalOperationProgressStart(){this.statusCapableOperationActive&&this.operationStatus.display(!1),this.operationProgress.display(!0)}signalOperationProgressComplete(){this.operationProgress.display(!1),this.statusCapableOperationActive&&this.operationStatus.display(!0)}signalOperationStatusStart(){this.initialLoaderActive&&this.operationProgress.display(!1),this.operationStatus.setStatus(void 0),this.operationStatus.display(!0),this.statusCapableOperationActive=!0}signalOperationStatusChanged(t){this.operationStatus.setStatus(t)}signalOperationStatusComplete(){this.operationStatus.display(!1),this.statusCapableOperationActive=!1}}}(Edit||(Edit={})),function(t){class e{static post(t,i,r,n,s,o=!1){let a=i instanceof FormData,l=a?i:e.encodeObject(i);e.postWithRetry(t,l,a,r,n,s,o,!0)}static postWithRetry(i,r,n,s,o,a,l,c){let d=new XMLHttpRequest;d.onreadystatechange=function(){d.readyState===XMLHttpRequest.DONE&&(200===d.status?(s&&s(),o(JSON.parse(d.responseText))):l&&c?e.postWithRetry(i,r,n,s,o,a,l,!1):(s&&s(),a(d)))},d.open("POST",i,!0),n||d.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8");try{d.send(r)}catch(e){t.GAEventLogger.logError("Ajax",`Url:${i}, Error:${e.message}`)}}static encodeObject(t){let e=[],i=/%20/g;for(let r in t){let n=t[r],s=void 0===n?"":n,o=`${encodeURIComponent(r).replace(i,"+")}=${encodeURIComponent(s).replace(i,"+")}`;e.push(o)}return e.join("&")}}t.Ajax=e}(Utils||(Utils={})),Shared||(Shared={}),new class{constructor(){Utils.BrowserUtils.onDocumentReady((function(){let t=document.querySelector("#cookieConsentAccept");t&&t.addEventListener("click",(function(t){document.cookie=t.target.getAttribute("data-cookie-string");let e=document.querySelector("#cookieConsent");e.classList.add("d-none"),e.classList.remove("d-flex")}))}))}},function(t){class e{constructor(){Utils.BrowserUtils.onDocumentReady((function(){e.Menus.forEach((function(t){new i(t)})),i.initHideOnClick(e.Menus)}))}}e.Menus=["#lang","#menu"],t.DropdownMenus=e;class i{constructor(t){document.querySelector(`${t} > .${i.DropdownToggleClass}`).addEventListener("click",(function(r){e.Menus.filter((e=>e!==t)).forEach(i.hideMenu),document.querySelector(`${t} > .${i.DropdownMenuClass}`).classList.toggle(i.ShowDropdownClass),r.preventDefault(),r.stopPropagation()}))}static initHideOnClick(t){window.addEventListener("click",(function(){t.forEach(i.hideMenu)}))}static hideMenu(t){let e=document.querySelector(`${t} > .${i.DropdownMenuClass}`);e.classList.contains(i.ShowDropdownClass)&&e.classList.remove(i.ShowDropdownClass)}}i.DropdownToggleClass="dropdown-toggle",i.DropdownMenuClass="dropdown-menu",i.ShowDropdownClass="show-dropdown"}(Shared||(Shared={}));class EditPage{constructor(){this.imgSelector="#editPanel",new Utils.GAJsErrorLogger("Edit"),this.hasImage="true"===document.querySelector("#hasImageHdn").value,this.hasImage?(this.imgResizer=new Utils.ImageResize(this.imgSelector),(new EditPanel).init(this.imgResizer),new EditToolbox(this.imgSelector).init(),this.progressMediator=new Edit.Progress.ProgressMediator):new EditToolbox(this.imgSelector).init(),new Shared.DropdownMenus}registerOperation(t){t.setImageResizer(this.imgResizer),t.setProgressMediator(this.progressMediator)}}class EditToolbox{constructor(t){this.editToolboxSelector="#editToolbox",this.toolboxChangedTriggered=!1,this.triggerSelectedToolboxChangedEventOnLoad=async t=>{let e=document.querySelector("#editToolbox .toolbox-panel.collapse.show"),i=e?e.getAttribute("data-toolboxid"):void 0;if(i||!t)await this.loadOperationJs(i),this.triggerSelectedToolboxChangedEvent(i);else{let t=this;setTimeout((function(){t.triggerSelectedToolboxChangedEventOnLoad(!1)}),500)}},this.editPanelSelector=t}init(){Utils.BrowserUtils.onDocumentReady((()=>{document.querySelector("#editMenu").addEventListener("click",(t=>{this.imageEditingActive||this.handleEditMenuClick(t.target)}));let t=function(t){t.preventDefault()};Utils.HtmlUtils.each("#editMenu a.toolbox-nav-link",(function(e){e.addEventListener("click",t)}));let e=t=>{this.imageEditingActive||this.expandCollapsed(t.currentTarget)};Utils.HtmlUtils.each("#editToolbox div.card-item-header",(function(t){t.addEventListener("click",e)}));let i=t=>{let e=t.currentTarget;this.setParentToolboxVisible(e,"toolbox",!0),this.setExpanderAriaExpandedAttr(e,!1)},r=t=>{let e=t.currentTarget;this.setParentToolboxVisible(e,"toolbox",!1),this.setActiveEditMenuItem(e),this.setExpanderAriaExpandedAttr(e,!0)};Utils.HtmlUtils.each("#editToolbox .toolbox-panel",(function(t){t.addEventListener("hide.bs.collapse",i),t.addEventListener("show.bs.collapse",r)}));let n=()=>{this.toolboxChangedTriggered||(this.triggerSelectedToolboxChangedEventOnLoad(!0),this.toolboxChangedTriggered=!0)},s=document.querySelector(this.editPanelSelector);s&&(s.addEventListener("imageOperationStartEvent",(()=>{this.imageEditingActive=!0})),s.addEventListener("imageOperationCompleteEvent",(()=>{this.imageEditingActive=!1})),s.complete?n():Utils.EventUtils.oneTimeEvent(s,"load",n)),Utils.BrowserUtils.onWindowLoad(n)}))}handleEditMenuClick(t){let e=Utils.HtmlUtils.closestWithClass(t,"edit-menu-nav",!0);e&&this.expandCollapsed(e)}async expandCollapsed(t){let e=document.querySelector(Utils.HtmlUtils.getIdSelector(t.getAttribute("aria-controls")));if(!e.classList.contains("collapse")||!e.classList.contains("show")){new bootstrap.Collapse(e,{toggle:!1,parent:"#editToolbox"}).show();let t=e.getAttribute("data-toolboxid");await this.loadOperationJs(t),this.triggerSelectedToolboxChangedEvent(t)}}async loadOperationJs(t){let e=scriptConfig.scripts.find((e=>e.id===t)),i=scriptConfig.basePath+e.path+"?v="+scriptConfig.version,r=new Utils.JSLoader(i,e.fallbackObj);try{await r.loadScript()}catch(e){Utils.GAEventLogger.logError(`Load${t}Js`,e.message)}return Promise.resolve()}triggerSelectedToolboxChangedEvent(t){Utils.EventUtils.triggerCustomEvent(document.querySelector(this.editToolboxSelector),"selectedToolboxChanged",{toolboxId:t})}setActiveEditMenuItem(t){let e=Utils.HtmlUtils.getAriaLabeledBy(t).filter((function(t){return!!document.querySelector(Utils.HtmlUtils.getIdSelector(t)).classList.contains("edit-menu-nav")})).shift();document.querySelector("#editMenu a.toolbox-nav-link.active").classList.remove("active"),document.querySelector(Utils.HtmlUtils.getIdSelector(e)).classList.add("active")}setExpanderAriaExpandedAttr(t,e){Utils.HtmlUtils.getAriaLabeledBy(t).forEach((function(t){document.querySelector(Utils.HtmlUtils.getIdSelector(t)).setAttribute("aria-expanded",e.toString())}))}setParentToolboxVisible(t,e,i){let r="d-block",n="d-sm-none",s=Utils.HtmlUtils.closestWithClass(t,e,!1).classList;i?(s.add(r,n),s.contains(n)||s.add(n)):(s.remove(r,n),s.contains(n)&&s.remove(n))}}class EditPanel{constructor(){this.resizeHanlderRegistered=!1}init(t){let e=()=>{this.resizeHanlderRegistered||(window.addEventListener("resize",(function(){t.resizeImageToFitContainer()})),this.resizeHanlderRegistered=!0,t.resizeImageToFitContainer())};Utils.BrowserUtils.onDocumentReady((function(){let i=t.image;i.complete?e():(Utils.EventUtils.oneTimeEvent(i,"load",e),Utils.EventUtils.oneTimeEvent(i,"error",e))}))}}let editPage=new EditPage;